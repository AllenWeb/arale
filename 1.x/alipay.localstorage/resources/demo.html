<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<title>editable demo</title>
    <style type="text/css" media="screen" id="test">
		#demo{
			width:300px;
			height:100px;
			border:1px solid blue;
			margin:30px;
			text-align:center;
			line-height:100px;
			font-size:12px;
		}
    </style>
     <script type="text/javascript">
       	araleConfig = {
			//一些个性化配置
			combo_host: 'stati.dev.alipay.net',
			combo_path: '/min/?b=ar&f='
		}
     </script>
	 <!--
    <script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'></script>
	-->
	
	
</head>
<body>
	<h1>你储存的内容</h1>
	<div id="content">
		
	</div>
	
	<h1>添加</h1>
	<form id="form1">
		<p>key:<input name="key1" id="key1" /></p>
		<p>value:<input name="value1" id="value1" /></p>
		<input name="input1" id="input1" value="确定" type="submit" />
	</form>
	
	<h1>获取单项</h1>
	<form id="form2">
		<p>key:<input name="key2" id="key2" /></p>
		<input name="input2" id="input2" value="load" type="submit" />
	</form>
	
	<h1>清空</h1>
	<a href="#" id="clear" onclick="">清空</a>
    <script type="text/javascript" charset="utf-8" src="http://assets.dev.alipay.net/ar/arale.sloader-2.0-SNAPSHOT-src.js"></script>
    <script type="text/javascript" charset="utf-8">
        seajs.config({
            base: 'http://assets.dev.alipay.net/??',
            preload: ['arale.sp-combo-2.0-SNAPSHOT.js'],
            charset: 'utf-8',
            timeout: 20000,
            debug: true
        });
    </script>
	<script>
        seajs.use(['arale.base-${version}.js', '${artifactId}-${version}.js', 'arale.event-${version}.js', 'arale.dom-${version}.js'], function(arale, ls, $E, dom) {
            var $ = dom.$; 
            arale.domReady(function(){
                var index = [];
                if(ls.isSupport){
                    var all = ls.all(),html = '';
                    
                    if(ls.supportLocalStorage){
                        html += '<p>本浏览器支持html5 LocalStorage</p>'; 
                    }else if(ls.supportUserData){
                        html += '<p>本浏览器支持M$ userData</p>'; 
                    }else{
                        html += '<p>本浏览器不支持本地存储</p>'; 
                    }
                    
                    html += '<p>共：'+ls.size()+'个</p>'; 
                    
                    for(i in all){
                        var k = i,v=all[i];
                        if(v) html += '<p>'+k+':'+v+'<a href="#" class="delete1" data-key="'+k+'">删除</a></p>'
                    }
                    $('content').setHtml(html);
                    $E.connect(dom.$$('.delete1'),'click',function(e){
                        var key = dom.$(e.currentTarget).attr('data-key');
                        ls.remove(key);
                        location.reload();
                    });
                }

                $E.connect($('form1'),'submit',function(e){
                    var k = $('key1').attr('value'),v = $('value1').attr('value');
                    if(k&&v){
                        ls.set(k,v);
                    }
                });

                $E.connect($('form2'),'submit',function(e){
                    var k = $('key2').attr('value');
                    alert(ls.get(k));
                    e.preventDefault();
                });

                $E.connect($('clear'),'click',function(e){
                    ls.clear();
                    location.reload();
                });
            });
        });    
	</script>
</body>
</html>
